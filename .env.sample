# Example environment configuration for Chessmate.
# Copy this file to .env and adjust the values for your setup.
# See docs/handbook/OPERATIONS.md and docs/handbook/DEVELOPER.md for detailed reference.

## Core service endpoints (required)
DATABASE_URL=postgres://chess:chess@localhost:5433/chessmate
QDRANT_URL=http://localhost:6333
CHESSMATE_API_URL=http://localhost:8080

## API server configuration
# CHESSMATE_API_PORT=8080
# CHESSMATE_DB_POOL_SIZE=10

## Rate limiting (per-IP quotas)
# CHESSMATE_RATE_LIMIT_REQUESTS_PER_MINUTE=60
# CHESSMATE_RATE_LIMIT_BUCKET_SIZE=60  # burst capacity; defaults to requests_per_minute
# CHESSMATE_RATE_LIMIT_BODY_BYTES_PER_MINUTE=  # optional body-size quota
# CHESSMATE_RATE_LIMIT_BODY_BUCKET_SIZE=  # burst capacity for body quota
# CHESSMATE_MAX_REQUEST_BODY_BYTES=1048576  # 1 MiB default; set 0 to disable

## Qdrant vector store configuration
# QDRANT_COLLECTION_NAME=positions
# QDRANT_VECTOR_SIZE=1536
# QDRANT_DISTANCE=Cosine

## Ingestion & embedding worker
OPENAI_API_KEY=replace-with-your-openai-key
# CHESSMATE_MAX_PENDING_EMBEDDINGS=250000  # queue guard; <=0 disables
# CHESSMATE_INGEST_CONCURRENCY=4  # parallel PGN parsing workers
# CHESSMATE_WORKER_BATCH_SIZE=16  # jobs claimed per poll
# CHESSMATE_WORKER_HEALTH_PORT=8081  # worker health/metrics endpoint
# CHESSMATE_WORKER_METRICS_PATH=  # optional file path for textfile metrics export
# OPENAI_EMBEDDING_CHUNK_SIZE=2048  # max FEN batch size
# OPENAI_EMBEDDING_MAX_CHARS=120000  # character limit per batch
# OPENAI_EMBEDDING_ENDPOINT=https://api.openai.com/v1/embeddings
# OPENAI_RETRY_MAX_ATTEMPTS=5
# OPENAI_RETRY_BASE_DELAY_MS=200

## GPT-5 agent configuration (optional re-ranking)
AGENT_API_KEY=replace-with-your-gpt5-key
AGENT_REASONING_EFFORT=medium
# AGENT_MODEL=gpt-5  # also supports gpt-5-mini, gpt-5-nano
# AGENT_VERBOSITY=medium  # low|medium|high
# AGENT_REQUEST_TIMEOUT_SECONDS=15  # timeout for GPT-5 calls
# AGENT_ENDPOINT=https://api.openai.com/v1/responses
# AGENT_CANDIDATE_MULTIPLIER=3  # candidate pool multiplier
# AGENT_CANDIDATE_MAX=30  # absolute candidate limit
# AGENT_CIRCUIT_BREAKER_THRESHOLD=5  # consecutive failures before opening
# AGENT_CIRCUIT_BREAKER_COOLOFF_SECONDS=60  # recovery delay

## Agent caching
# AGENT_CACHE_REDIS_URL=redis://localhost:6379/0
# AGENT_CACHE_REDIS_NAMESPACE=chessmate:agent
# AGENT_CACHE_TTL_SECONDS=86400  # cache entry TTL
# AGENT_CACHE_CAPACITY=1000  # fallback in-memory cache size

## Agent telemetry cost estimates (USD per 1K tokens)
# AGENT_COST_INPUT_PER_1K=0.010
# AGENT_COST_OUTPUT_PER_1K=0.030
# AGENT_COST_REASONING_PER_1K=0.060

## Testing
# CHESSMATE_TEST_DATABASE_URL=postgres://chess:chess@localhost:5433/postgres

## Operational tooling
# CHESSMATE_SNAPSHOT_LOG=snapshots/qdrant_snapshots.jsonl  # snapshot metadata journal
# CHESSMATE_OPENAPI_SPEC=  # override OpenAPI spec path